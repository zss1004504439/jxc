<html xmlns="http://www.w3.org/1999/xhtml">

<head>

  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>By：德马</title>

  <script type="text/javascript">
    //下面用于多图片上传预览功能

    function setImagePreviews(avalue) {

      var docObj = document.getElementById("doc");

      var dd = document.getElementById("dd");

      dd.innerHTML = "";

      var fileList = docObj.files;

      for (var i = 0; i < fileList.length; i++) {



        dd.innerHTML += "<div style='float:none;text-align: center;' > <img id='img" + i + "'  /> </div>";

        var imgObjPreview = document.getElementById("img" + i);

        if (docObj.files && docObj.files[i]) {

          //火狐下，直接设img属性

          // imgObjPreview.style.display = 'block';

          imgObjPreview.style.width = '150px';

          imgObjPreview.style.height = '150px';

          //imgObjPreview.src = docObj.files[0].getAsDataURL();

          //火狐7以上版本不能用上面的getAsDataURL()方式获取，需要一下方式

          imgObjPreview.src = window.URL.createObjectURL(docObj.files[i]);

        } else {

          //IE下，使用滤镜

          docObj.select();

          var imgSrc = document.selection.createRange().text;

          alert(imgSrc)

          var localImagId = document.getElementById("img" + i);

          //必须设置初始大小

          localImagId.style.width = "150px";

          localImagId.style.height = "150px";

          //图片异常的捕捉，防止用户修改后缀来伪造图片

          try {

            localImagId.style.filter = "progid:DXImageTransform.Microsoft.AlphaImageLoader(sizingMethod=scale)";

            localImagId.filters.item("DXImageTransform.Microsoft.AlphaImageLoader").src = imgSrc;

          } catch (e) {

            alert("您上传的图片格式不正确，请重新选择!");

            return false;

          }

          imgObjPreview.style.display = 'none';

          document.selection.empty();

        }

      }



      return true;

    }
  </script>
  <link rel="stylesheet" href="../css/mui.min.css">
<style> 
  #up-img-box{ margin :0px auto; width:100%;position: relative;     text-align: center;}
  #up-img-box #doc{ position: absolute;left: 0;right: 0;top: 0; height: 40px;;opacity: 0; width: 100%;}

</style>
</head>



<body>

  <div id="up-img-box">
    <button>选择图片上传</button>
    <input type="file" name="file" id="doc" multiple="multiple"   onchange="javascript:setImagePreviews();"
      accept="image/*" />
    <div id="dd"></div>
  </div>

</body>

</html>